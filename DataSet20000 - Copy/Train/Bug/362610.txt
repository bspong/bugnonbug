FF reports as default browser but IE7 on Vista is still the default
User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1) Gecko/20061010 Firefox/2.0
Build Identifier: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.8.1) Gecko/20061010 Firefox/2.0

Vista RC1 build 5600 and my FF work fine except for one error. Vista's IE7 will not let FF become the default browser. FF reports and checks itself as the default browser OK. But click on a url and IE7 always opens. IE7 does not say it is the default browser however. Forums throughout the internet are full of this problem but there is no definitive solution.

FF opens manually and browses perfectly and I can cut&paste the url into the address box. 

I have manually set FF to be the default in about:config with setbrowsershell

I have also redone all Vistas file associations to point to FF

I have reinstalled FF twice

The problem was not noticed initially so can not correlate it with any changes to my system

Reproducible: Always

Steps to Reproduce:
1.install FF 2.0
2.set it to check it is default browser
3.close then click on a url in an email in Windows Mail in Vista RC1 / 5600

Actual Results:  
IE7 opens

Expected Results:  
Firefox should open

I am using Firefox exactly as installed and before making any modifications to the theme or using any addons