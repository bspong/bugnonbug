Upgrading Portable Firefox on a pendrive removes Default Program Settings on Vista
User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 6.0; it; rv:1.8.1.4) Gecko/20070515 Firefox/2.0.0.4
Build Identifier: Mozilla/5.0 (Windows; U; Windows NT 6.0; it; rv:1.8.1.4) Gecko/20070515 Firefox/2.0.0.4

I had installed 2.0.0.3 using the installer, and it worked flawlessy, adding a new Firefox item in Default Programs dialog.
So, i had set up Firefox as the default browser in Vista and links (for example from Office documents) opened into it.

After automatic update to 2.0.0.4 links and pages are served by ie7, Firefox item in Default Programs has disappeared and cannot reset it as the default handler.

I think that the only way to make it working again is to reinstall it from the installer.

Bug 354005 is about this but is marked as Resolved fixed, don't know if that should be reopened and this be marked as duplicate or if it's about a new problem.

Reproducible: Always

Steps to Reproduce:
1. Install 2.0.0.3
2. Set firefox as default program in Start / Default Programs
3. Automatic Update to 2.0.0.4
Actual Results:  
The default program settings are lost

Expected Results:  
The default program settings are retained