Restoring firefox session sometimes opens windows and tabs from sessions prior to the last session
User-Agent:       Mozilla/5.0 (Windows; U; Windows NT 6.1; en-GB; rv:1.9.1.7) Gecko/20091221 Firefox/3.5.7 MMM (.NET CLR 3.5.30729) FirePHP/0.4
Build Identifier: Mozilla/5.0 (Windows; U; Windows NT 6.1; en-GB; rv:1.9.1.7) Gecko/20091221 Firefox/3.5.7 (.NET CLR 3.5.30729) FirePHP/0.4

when the option to restore tabs and windows from last time is enabled, you then browse to a bunch of websites, click on stuff, view enlarged pictures etc.
then you close the browser,
when you reopen you expect to see the same tabs that were open when you closed firefox, but sometimes firefox opens a different set of tabs (not necessarily including the ones you had open when you closed firefox) that you have visited some time ago. it may also open up several additional windows (most of these are enlargements that open new windows - off of shoping sites or galleries).

this can be quite irritating because a. you end up with a bunch of windows you then have to close, b. you loose the tabs you actually last had open.

Reproducible: Sometimes

Steps to Reproduce:
don't know exactly what causes it to happen, but it usually happens to me once a day or once every other day, and i use firefox a minimum of 4-5 hours most days.

1. open a bunch of tabs and sites that produce additional windows, e.g. any product on amazon.co.uk that has a zoom (click the zoom to get the additional window).
2. close those tabs, navigate to some other pages
3. close the session with firefox

4. open the session with firefox
5. bug may occur or browsing may be normal
6. close the session...
7. open ...
8. browsing may be normal or you may get all windows popups and tabs from when you were on amazon, (and not just one zoom window, but all the ones you looked at)
Actual Results:  
browsing may be normal or you may get all windows popups and tabs from when you were on amazon, (and not just one zoom window, but all the ones you looked at)

Expected Results:  
the tabs you were looking at when you closed firefox