Wrong ajax callback response when reloading or going to another page
User-Agent: Mozilla/4.0 (compatible; MSIE 7.0; Windows NT 5.1; .NET CLR 1.1.4322; InfoPath.2; .NET CLR 2.0.50727; .NET CLR 3.0.4506.2152; .NET CLR 3.5.30729)
Build Identifier: Mozilla/5.0 (Windows; U; Windows NT 5.1; en-US; rv:1.9.0.8) Gecko/2009032609 Firefox/3.0.8 (.NET CLR 3.5.30729)

If you have Ajax request in queue and you reload the page or go to another page, the "onreadystatechange" function is still being reached with "status=0" (other browser seem to drop these request once you moved to a new page (let's say, a page that hasn't requested anything yet)

Reproducible: Always

Steps to Reproduce:
In the following example:

1. Click several time on "request file by Ajax" to cause that some request are queued.

2. Immediatly afterward reload the page or click on "Go to another site".





<html>
<head>
<title>Ajax test</title>
<script language="javascript">

var req;

function loadXMLDoc(url)
{
// branch for native XMLHttpRequest object
if (window.XMLHttpRequest) {
req = new XMLHttpRequest();
req.onreadystatechange = processReqChange;
req.open("GET", url, true);
req.send(null);
// branch for IE/Windows ActiveX version
} else if (window.ActiveXObject) {
req = new ActiveXObject("Microsoft.XMLHTTP");
if (req) {
req.onreadystatechange = processReqChange;
req.open("GET", url, true);
req.send();
}
}
}

function processReqChange()
{
// only if req show "complete"
if (req.readyState == 4) {
// only if "OK"
if (req.status == 200) {
callback_requestFile();
} else {
alert("Problems retrieving data.\n[Status: " + req.status + "]");
}
}

}

function requestFile(x)
{
loadXMLDoc("bigfile.txt?rnd=" + Math.random());
}

function callback_requestFile()
{
// Do something
}
</script>
</head>
<body>
<a href="javascript: requestFile()">Request file by AJAX</a>
<br>
<br>
<a href="javascript: window.location.href='http://www.mozilla.com'">Go to another site!!</a>
</body>
</html>


Actual Results:
You'll se the message box with the error.

Expected Results:
Drop ajax request generated by other page than the current page

There are many site which use ajax and if you click on reload while a request is pending you get an error. For example, the (new) yahoo webmail among others.
