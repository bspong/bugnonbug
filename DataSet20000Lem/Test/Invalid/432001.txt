FF3 Beta: open link in new window/tab prompt to save file
User-Agent: Mozilla/5.0 (X11; U; Linux i686 (x86_64); en-GB; rv:1.9b5) Gecko/2008032619 Firefox/3.0b5
Build Identifier: Mozilla/5.0 (X11; U; Linux i686 (x86_64); en-GB; rv:1.9b5) Gecko/2008032619 Firefox/3.0b5

A strange bug when using Firefox 3 Beta 5 (I have also confirmed that it persists with Beta 4 and when running Firefox in safe mode.)
In a very specific situation, right-clicking on a link and selecting "open in new window" or "open in new tab", instead of displaying what's requested, launch a save file dialogue.

I suspect this may in some way be related to bug 409192, which cause me to have nothing in the application dialogue, meaning I can't control what application are used by Firefox to open files.

Strangely, this bug seems to come and go. For long period everything work fine, then it start playing up and continues causing problem for day on end.


Reproducible: Sometimes

Steps to Reproduce:
1. Visit http://www.suffolkcamra.co.uk/pubs/pub/2346
2. Click on the picture of a pub under the caption "picture gallery"
3. Right-click on the smaller picture that appears and select "open link in new window"

Actual Results:
New window opens, with dialogue asking what to do with the cgi file

Expected Results:
Should open a new window and display the picture generated by the cgi script.

The link concerned is slightly more complicated than usual, a it point at a script which pick a photograph out of a database and display it using Lightbox. The problem only seems to occur with link like this, other link open OK all the time. Opening in a new window (when it works) bypass the lightbox display and just display the picture.

There is an error message generated when doing the right-click and also when selecting "open in new window", but a this is generated when right-clicking on other links, is possibly irrelevant.
*** e = [Exception... "Component returned failure code: 0x80570016 (NS_ERROR_XPC_GS_RETURNED_FAILURE) [nsIJSCID.getService]" nsresult: "0x80570016 (NS_ERROR_XPC_GS_RETURNED_FAILURE)" location: "JS frame :: chrome://browser/content/utilityOverlay.js :: getShellService :: line 285" data: no]
